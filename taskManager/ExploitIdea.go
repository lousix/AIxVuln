package taskManager

type ExploitChain struct {
	ExploitIdea    []*ExploitIdea `json:"exploit_idea"` // 组成攻击链的可利用点
	Idea           string         `json:"idea"`         // 组链思路
	State          string         `json:"state"`
	ExploitChainId string         `json:"exploit_chain_id"`
	Evidence       string         `json:"evidence"`
	Poc            string         `json:"poc"`
	ReviewReason   string         `json:"review_reason,omitempty"` // 审核失败原因
}

type ExploitIdea struct {
	ExploitIdeaId string        `json:"exploitIdeaId"`
	Harm          string        `json:"harm"`         // 利用点危害（能做到什么）
	ExtendIdea    string        `json:"extend_idea"`  // 扩大化利用思路（可以用它干什么，然后更接近研究员的需求）
	Condition     string        `json:"condition"`    // 利用条件
	State         string        `json:"state"`        // 利用点状态：未验证/可利用/验证失败/审核失败
	ExploitPoint  *ExploitPoint `json:"exploit_point"` // 利用点具体信息
	Evidence      string        `json:"evidence"`
	Poc           string        `json:"poc"`
	ReviewReason  string        `json:"review_reason,omitempty"` // 审核失败原因
}

type ExploitPoint struct {
	Confidence       string `json:"confidence"`
	ExpectedImpact   string `json:"expected_impact"`
	File             string `json:"file"`
	FunctionOrMethod string `json:"function_or_method"`
	Params           string `json:"params"`
	PayloadIdea      string `json:"payload_idea"`
	RouteOrEndpoint  string `json:"route_or_endpoint"`
	Title            string `json:"title"`
	Type             string `json:"type"`
	ExploitId        string `json:"exploit_id"`
}
